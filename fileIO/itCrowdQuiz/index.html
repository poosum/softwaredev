<!DOCTYPE html>
<html>
    <head>
        <title>IT Crowd Quiz</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    </head>

    <body>
        <div class="container">
            <div class="row">
                <img class="text-center" src="img/moss.jpg">
            </div>

            <br><br>

            <div class="row">
                <div class="col">
                    <div class="custom-file">
                        <input type="file" class="custom-file-input" id="quizFileInput">
                        <label class="custom-file-label" for="quizFileInput">Choose file</label>
                    </div>
                </div>
                <div class="col">
                    <button class="btn btn-primary" onclick="readFile()">Go</button>
                </div>
            </div>

            <br><br>
            <div id="questionsOutput">

            </div>
            <button class="btn btn-primary d-none" id="submitButton" onclick="calculateScore()">Submit</button>
        </div>
        <br>
        <script>
            function calculateScore() {
                document.getElementById
            }

            function parseXML(xml) {
                let questions = xml.getElementsByTagName("quizzes")
                let output = document.getElementById("questionsOutput")
                let questionArray = []
                let questionNum = 1
                for (let question of questions[0].children) {
                    let questionObj = {}
                    questionObj.opt = []
                    let optNum = 1
                    for (let questionXML of question.children) {
                        if (questionXML.nodeName == "question") {
                            questionObj.question = questionXML.innerHTML
                        } else if (questionXML.nodeName == "answer") {
                            questionObj.answer = questionXML.innerHTML
                        } else if (questionXML.nodeName == "option") {
                            questionObj.opt.push({opt: questionXML.innerHTML, optNum: optNum, isCorrect: false})
                            optNum++
                        }
                    }
                    questionObj.qNum = questionNum
                    questionArray.push(questionObj)
                    questionNum++
                }
                let letterOpts = ["a", "b", "c", "d"]
                for (question of questionArray) {
                    for (opt of question.opt) {
                        let correct = false
                        console.log("current opt: "+letterOpts[opt.optNum - 1])
                        console.log("correct opt: "+question.answer)
                        if (letterOpts[opt.optNum - 1] == question.answer) {
                            correct = true
                        }
                        opt.isCorrect = correct
                    }
                }
                console.log(questionArray)
                for (question of questionArray) {
                    output.innerHTML += '<h4>'+question.question+'</h4>'
                    for (option of question.opt) {
                        output.innerHTML += '<div class="form-check">'
                        output.innerHTML += 
                        `
                        <input class="form-check-input" type="radio" name="question-${question.qNum}" id="option-${question.qNum}-${option.optNum}" value="${option.isCorrect}">
                        <label class="form-check-label" for="option-${question.qNum}-${option.optNum}">
                            ${option.opt}
                        </label>
                        `
                        output.innerHTML += '</div>'
                    }
                }
                output.innerHTML += "<br><br>"

                document.getElementById("submitButton").classList = "btn btn-primary"
            }

            function readFile() {
                let xmlHTTP = new XMLHttpRequest()
                xmlHTTP.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        parseXML(this.responseXML)
                    }
                }
                xmlHTTP.open("GET", "quiz.xml", true)
                xmlHTTP.send()
            }
        </script>
    </body>
</html>